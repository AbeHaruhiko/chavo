// .These two lines are required to initialize Express in Cloud Code.
var express = require('express');
var app = express();
// .Global app configuration section
app.set('views', 'cloud/views'); // .Specify the folder to find templates
app.set('view engine', 'ejs'); // .Set the template engine
app.use(express.bodyParser()); // .Middleware for reading request body
// .This is an example of hooking up a request handler with a specific request
// path and HTTP verb using the Express routing API.
app.get('/hello', function (req, res) {
    res.render('hello', { message: 'Congrats, you just set up your app!' });
});
// // Example reading from the request query string of an HTTP get request.
// app.get('/test', function(req, res) {
//   // GET http://example.parseapp.com/test?message=hello
//   res.send(req.query.message);
// });
// // Example reading from the request body of an HTTP post request.
// app.post('/test', function(req, res) {
//   // POST http://example.parseapp.com/test (with request body "message=hello")
//   res.send(req.body.message);
// });
app.get('/post/:objectId', function (req, res) {
    var ParseVoice = Parse.Object.extend('Voice');
    var query = new Parse.Query(ParseVoice);
    query.descending('createdAt');
    query.include('user');
    query.equalTo('objectId', req.params.objectId);
    console.log('koko1');
    query.first()
        .then(function (result) {
        console.log('koko2');
        res.render('post', { objectId: req.params.objectId, voice: new chavoCloud.Voice(result, req.user ? req.user.get('likes') : []) });
    });
});
// .Attach the Express app to Cloud Code.
app.listen();
var chavoCloud;
(function (chavoCloud) {
    'use strict';
    var Voice = (function () {
        function Voice(voice, likes) {
            this.constructVoiceFromParseVoice(voice, likes);
        }
        Voice.prototype.constructVoiceFromParseVoice = function (voice, likes) {
            this.objectId = voice.id;
            this.description = voice.get('description');
            this.tags = voice.get('tags');
            this.speaker = voice.get('author');
            this.age = this.makeAgeString(voice.get('ageYears'), voice.get('ageMonths'));
            this.ageYears = voice.get('ageYears');
            this.ageMonths = voice.get('ageMonths');
            this.gender = voice.get('gender') === 0 ? '男の子' : voice.get('gender') === 1 ? '女の子' : '';
            this.genderValue = voice.get('gender');
            this.user = voice.get('user').get('username');
            this.userObjectId = voice.get('user').id;
            this.icon = voice.get('user').get('iconUrl') === undefined ?
                voice.get('icon') === undefined ? null : voice.get('icon').url()
                : voice.get('user').get('iconUrl');
            this.like = likes.indexOf(voice.id) >= 0 ? true : false;
            this.likeCount = voice.get('likeCount');
            this.photoUrl = voice.get('photoUrl');
            this.isPublic = voice.getACL().getPublicReadAccess();
            // this.createdAt = moment(voice.createdAt).format('YYYY/MM/DD').toString();
        };
        Voice.prototype.makeAgeString = function (ageYears, ageMonths) {
            if (ageYears && ageMonths) {
                return ageYears + '歳' + ageMonths + 'ヶ月';
            }
            else if (ageYears) {
                return ageYears + '歳';
            }
            else {
                return '0歳' + ageMonths + 'ヶ月';
            }
        };
        return Voice;
    })();
    chavoCloud.Voice = Voice;
    (function (GENDER) {
        GENDER[GENDER["MALE"] = 0] = "MALE";
        GENDER[GENDER["FEMALE"] = 1] = "FEMALE";
        GENDER[GENDER["OTHER"] = 2] = "OTHER";
    })(chavoCloud.GENDER || (chavoCloud.GENDER = {}));
    var GENDER = chavoCloud.GENDER;
})(chavoCloud || (chavoCloud = {}));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNsb3VkL2FwcC50cyJdLCJuYW1lcyI6WyJjaGF2b0Nsb3VkIiwiY2hhdm9DbG91ZC5Wb2ljZSIsImNoYXZvQ2xvdWQuVm9pY2UuY29uc3RydWN0b3IiLCJjaGF2b0Nsb3VkLlZvaWNlLmNvbnN0cnVjdFZvaWNlRnJvbVBhcnNlVm9pY2UiLCJjaGF2b0Nsb3VkLlZvaWNlLm1ha2VBZ2VTdHJpbmciLCJjaGF2b0Nsb3VkLkdFTkRFUiJdLCJtYXBwaW5ncyI6IkFBQ0EscUVBQXFFO0FBQ3JFLElBQUksT0FBTyxHQUFHLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQztBQUNqQyxJQUFJLEdBQUcsR0FBRyxPQUFPLEVBQUUsQ0FBQztBQUVwQixvQ0FBb0M7QUFDcEMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsYUFBYSxDQUFDLENBQUMsQ0FBRSx3Q0FBd0M7QUFDMUUsR0FBRyxDQUFDLEdBQUcsQ0FBQyxhQUFhLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBSSwyQkFBMkI7QUFDN0QsR0FBRyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQyxDQUFJLHVDQUF1QztBQUV6RSw4RUFBOEU7QUFDOUUsb0RBQW9EO0FBQ3BELEdBQUcsQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUFFLFVBQVMsR0FBUSxFQUFFLEdBQVE7SUFDM0MsR0FBRyxDQUFDLE1BQU0sQ0FBQyxPQUFPLEVBQUUsRUFBRSxPQUFPLEVBQUUscUNBQXFDLEVBQUUsQ0FBQyxDQUFDO0FBQzFFLENBQUMsQ0FBQyxDQUFDO0FBRUgsMkVBQTJFO0FBQzNFLHdDQUF3QztBQUN4QywwREFBMEQ7QUFDMUQsaUNBQWlDO0FBQ2pDLE1BQU07QUFFTixvRUFBb0U7QUFDcEUseUNBQXlDO0FBQ3pDLGlGQUFpRjtBQUNqRixnQ0FBZ0M7QUFDaEMsTUFBTTtBQUVOLEdBQUcsQ0FBQyxHQUFHLENBQUMsaUJBQWlCLEVBQUUsVUFBUyxHQUFRLEVBQUUsR0FBUTtJQUdwRCxJQUFJLFVBQVUs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SUEsU0FBU0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQzFCQSxNQUFNQSxDQUFDQSxRQUFRQSxHQUFHQSxHQUFHQSxHQUFHQSxTQUFTQSxHQUFHQSxJQUFJQSxDQUFDQTtZQUMzQ0EsQ0FBQ0E7WUFBQ0EsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsUUFBUUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ3BCQSxNQUFNQSxDQUFDQSxRQUFRQSxHQUFHQSxHQUFHQSxDQUFDQTtZQUN4QkEsQ0FBQ0E7WUFBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7Z0JBQ05BLE1BQU1BLENBQUNBLElBQUlBLEdBQUdBLFNBQVNBLEdBQUdBLElBQUlBLENBQUNBO1lBQ2pDQSxDQUFDQTtRQUNIQSxDQUFDQTtRQUNISCxZQUFDQTtJQUFEQSxDQTdEQUQsQUE2RENDLElBQUFEO0lBN0RZQSxnQkFBS0EsUUE2RGpCQSxDQUFBQTtJQUVEQSxXQUFZQSxNQUFNQTtRQUNoQkssbUNBQUlBLENBQUFBO1FBQ0pBLHVDQUFNQSxDQUFBQTtRQUNOQSxxQ0FBS0EsQ0FBQUE7SUFDUEEsQ0FBQ0EsRUFKV0wsaUJBQU1BLEtBQU5BLGlCQUFNQSxRQUlqQkE7SUFKREEsSUFBWUEsTUFBTUEsR0FBTkEsaUJBSVhBLENBQUFBO0FBQ0hBLENBQUNBLEVBdkVNLFVBQVUsS0FBVixVQUFVLFFBdUVoQiIsImZpbGUiOiJjbG91ZC9hcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbi8vIC5UaGVzZSB0d28gbGluZXMgYXJlIHJlcXVpcmVkIHRvIGluaXRpYWxpemUgRXhwcmVzcyBpbiBDbG91ZCBDb2RlLlxudmFyIGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG52YXIgYXBwID0gZXhwcmVzcygpO1xuXG4vLyAuR2xvYmFsIGFwcCBjb25maWd1cmF0aW9uIHNlY3Rpb25cbmFwcC5zZXQoJ3ZpZXdzJywgJ2Nsb3VkL3ZpZXdzJyk7ICAvLyAuU3BlY2lmeSB0aGUgZm9sZGVyIHRvIGZpbmQgdGVtcGxhdGVzXG5hcHAuc2V0KCd2aWV3IGVuZ2luZScsICdlanMnKTsgICAgLy8gLlNldCB0aGUgdGVtcGxhdGUgZW5naW5lXG5hcHAudXNlKGV4cHJlc3MuYm9keVBhcnNlcigpKTsgICAgLy8gLk1pZGRsZXdhcmUgZm9yIHJlYWRpbmcgcmVxdWVzdCBib2R5XG5cbi8vIC5UaGlzIGlzIGFuIGV4YW1wbGUgb2YgaG9va2luZyB1cCBhIHJlcXVlc3QgaGFuZGxlciB3aXRoIGEgc3BlY2lmaWMgcmVxdWVzdFxuLy8gcGF0aCBhbmQgSFRUUCB2ZXJiIHVzaW5nIHRoZSBFeHByZXNzIHJvdXRpbmcgQVBJLlxuYXBwLmdldCgnL2hlbGxvJywgZnVuY3Rpb24ocmVxOiBhbnksIHJlczogYW55KSB7XG4gIHJlcy5yZW5kZXIoJ2hlbGxvJywgeyBtZXNzYWdlOiAnQ29uZ3JhdHMsIHlvdSBqdXN0IHNldCB1cCB5b3VyIGFwcCEnIH0pO1xufSk7XG5cbi8vIC8vIEV4YW1wbGUgcmVhZGluZyBmcm9tIHRoZSByZXF1ZXN0IHF1ZXJ5IHN0cmluZyBvZiBhbiBIVFRQIGdldCByZXF1ZXN0LlxuLy8gYXBwLmdldCgnL3Rlc3QnLCBmdW5jdGlvbihyZXEsIHJlcykge1xuLy8gICAvLyBHRVQgaHR0cDovL2V4YW1wbGUucGFyc2VhcHAuY29tL3Rlc3Q/bWVzc2FnZT1oZWxsb1xuLy8gICByZXMuc2VuZChyZXEucXVlcnkubWVzc2FnZSk7XG4vLyB9KTtcblxuLy8gLy8gRXhhbXBsZSByZWFkaW5nIGZyb20gdGhlIHJlcXVlc3QgYm9keSBvZiBhbiBIVFRQIHBvc3QgcmVxdWVzdC5cbi8vIGFwcC5wb3N0KCcvdGVzdCcsIGZ1bmN0aW9uKHJlcSwgcmVzKSB7XG4vLyAgIC8vIFBPU1QgaHR0cDovL2V4YW1wbGUucGFyc2VhcHAuY29tL3Rlc3QgKHdpdGggcmVxdWVzdCBib2R5IFwibWVzc2FnZT1oZWxsb1wiKVxuLy8gICByZXMuc2VuZChyZXEuYm9keS5tZXNzYWdlKTtcbi8vIH0pO1xuXG5hcHAuZ2V0KCcvcG9zdC86b2JqZWN0SWQnLCBmdW5jdGlvbihyZXE6IGFueSwgcmVzOiBhbnkpIHtcblxuXG4gIHZhciBQYXJzZVZvaWNlID0gUGFyc2UuT2JqZWN0LmV4dGVuZCgnVm9pY2UnKTtcbiAgdmFyIHF1ZXJ5ID0gbmV3IFBhcnNlLlF1ZXJ5KFBhcnNlVm9pY2UpO1xuXG4gIHF1ZXJ5LmRlc2NlbmRpbmcoJ2NyZWF0ZWRBdCcpO1xuICBxdWVyeS5pbmNsdWRlKCd1c2VyJyk7XG4gIHF1ZXJ5LmVxdWFsVG8oJ29iamVjdElkJywgcmVxLnBhcmFtcy5vYmplY3RJZCk7XG4gIGNvbnNvbGUubG9nKCdrb2tvMScpXG5cbiAgcXVlcnkuZmlyc3QoKVxuICAudGhlbigocmVzdWx0OiBQYXJzZS5PYmplY3QpID0+IHtcbiAgICBjb25zb2xlLmxvZygna29rbzInKVxuXG4gICAgcmVzLnJlbmRlcigncG9zdCcsIHsgb2JqZWN0SWQ6IHJlcS5wYXJhbXMub2JqZWN0SWQsIHZvaWNlOiBuZXcgY2hhdm9DbG91ZC5Wb2ljZShyZXN1bHQsIHJlcS51c2VyID8gcmVxLnVzZXIuZ2V0KCdsaWtlcycpIDogW10pIH0pO1xuICB9KTtcblxuXG5cbn0pO1xuXG5cblxuLy8gLkF0dGFjaCB0aGUgRXhwcmVzcyBhcHAgdG8gQ2xvdWQgQ29kZS5cbmFwcC5saXN0ZW4oKTtcblxubW9kdWxlIGNoYXZvQ2xvdWQge1xuICAndXNlIHN0cmljdCc7XG5cbiAgZXhwb3J0IGNsYXNzIFZvaWNlIHtcblxuICAgIHB1YmxpYyBvYmplY3RJZDogc3RyaW5nO1xuICAgIHB1YmxpYyBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIHB1YmxpYyB0YWdzOiBzdHJpbmdbXTtcbiAgICBwdWJsaWMgc3BlYWtlcjogc3RyaW5nO1xuICAgIHB1YmxpYyBhZ2U6IHN0cmluZztcbiAgICBwdWJsaWMgYWdlWWVhcnM6IHN0cmluZztcbiAgICBwdWJsaWMgYWdlTW9udGhzOiBzdHJpbmc7XG4gICAgcHVibGljIGdlbmRlcjogc3RyaW5nO1xuICAgIHB1YmxpYyBnZW5kZXJWYWx1ZTogR0VOREVSO1xuICAgIHB1YmxpYyB1c2VyOiBzdHJpbmc7XG4gICAgcHVibGljIHVzZXJPYmplY3RJZDogc3RyaW5nO1xuICAgIHB1YmxpYyBpY29uOiBzdHJpbmc7XG4gICAgcHVibGljIGxpa2U6IGJvb2xlYW47XG4gICAgcHVibGljIGxpa2VDb3VudDogbnVtYmVyO1xuICAgIHB1YmxpYyBwaG90b1VybDogc3RyaW5nO1xuICAgIHB1YmxpYyBpc1B1YmxpYzogYm9vbGVhbjtcbiAgICBwdWJsaWMgY3JlYXRlZEF0OiBzdHJpbmc7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgIHZvaWNlOiBQYXJzZS5PYmplY3QsXG4gICAgICBsaWtlczogc3RyaW5nW11cbiAgICAgICkge1xuICAgICAgICB0aGlzLmNvbnN0cnVjdFZvaWNlRnJvbVBhcnNlVm9pY2Uodm9pY2UsIGxpa2VzKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNvbnN0cnVjdFZvaWNlRnJvbVBhcnNlVm9pY2UoXG4gICAgICB2b2ljZTogUGFyc2UuT2JqZWN0LFxuICAgICAgbGlrZXM6IHN0cmluZ1tdXG4gICAgKSB7XG4gICAgICB0aGlzLm9iamVjdElkID0gdm9pY2UuaWQ7XG4gICAgICB0aGlzLmRlc2NyaXB0aW9uID0gdm9pY2UuZ2V0KCdkZXNjcmlwdGlvbicpO1xuICAgICAgdGhpcy50YWdzID0gdm9pY2UuZ2V0KCd0YWdzJyk7XG4gICAgICB0aGlzLnNwZWFrZXIgPSB2b2ljZS5nZXQoJ2F1dGhvcicpO1xuICAgICAgdGhpcy5hZ2UgPSB0aGlzLm1ha2VBZ2VTdHJpbmcodm9pY2UuZ2V0KCdhZ2VZZWFycycpLCB2b2ljZS5nZXQoJ2FnZU1vbnRocycpKTtcbiAgICAgIHRoaXMuYWdlWWVhcnMgPSB2b2ljZS5nZXQoJ2FnZVllYXJzJyk7XG4gICAgICB0aGlzLmFnZU1vbnRocyA9IHZvaWNlLmdldCgnYWdlTW9udGhzJyk7XG4gICAgICB0aGlzLmdlbmRlciA9IHZvaWNlLmdldCgnZ2VuZGVyJykgPT09IDAgPyAn55S344Gu5a2QJyA6IHZvaWNlLmdldCgnZ2VuZGVyJykgPT09IDEgPyAn5aWz44Gu5a2QJyA6ICcnO1xuICAgICAgdGhpcy5nZW5kZXJWYWx1ZSA9IHZvaWNlLmdldCgnZ2VuZGVyJyk7XG4gICAgICB0aGlzLnVzZXIgPSB2b2ljZS5nZXQoJ3VzZXInKS5nZXQoJ3VzZXJuYW1lJyk7XG4gICAgICB0aGlzLnVzZXJPYmplY3RJZCA9IHZvaWNlLmdldCgndXNlcicpLmlkO1xuICAgICAgdGhpcy5pY29uID0gdm9pY2UuZ2V0KCd1c2VyJykuZ2V0KCdpY29uVXJsJykgPT09IHVuZGVmaW5lZCA/XG4gICAgICAgICAgdm9pY2UuZ2V0KCdpY29uJykgPT09IHVuZGVmaW5lZCA/IG51bGwgOiB2b2ljZS5nZXQoJ2ljb24nKS51cmwoKVxuICAgICAgICAgICAgICA6IHZvaWNlLmdldCgndXNlcicpLmdldCgnaWNvblVybCcpO1xuICAgICAgdGhpcy5saWtlID0gbGlrZXMuaW5kZXhPZih2b2ljZS5pZCkgPj0gMCA/IHRydWUgOiBmYWxzZTtcbiAgICAgIHRoaXMubGlrZUNvdW50ID0gdm9pY2UuZ2V0KCdsaWtlQ291bnQnKTtcbiAgICAgIHRoaXMucGhvdG9VcmwgPSB2b2ljZS5nZXQoJ3Bob3RvVXJsJyk7XG4gICAgICB0aGlzLmlzUHVibGljID0gdm9pY2UuZ2V0QUNMKCkuZ2V0UHVibGljUmVhZEFjY2VzcygpO1xuICAgICAgLy8gdGhpcy5jcmVhdGVkQXQgPSBtb21lbnQodm9pY2UuY3JlYXRlZEF0KS5mb3JtYXQoJ1lZWVkvTU0vREQnKS50b1N0cmluZygpO1xuICAgIH1cblxuICAgIHByaXZhdGUgbWFrZUFnZVN0cmluZyhhZ2VZZWFyczogc3RyaW5nLCBhZ2VNb250aHM6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICBpZiAoYWdlWWVhcnMgJiYgYWdlTW9udGhzKSB7XG4gICAgICAgIHJldHVybiBhZ2VZZWFycyArICfmrbMnICsgYWdlTW9udGhzICsgJ+ODtuaciCc7XG4gICAgICB9IGVsc2UgaWYgKGFnZVllYXJzKSB7XG4gICAgICAgIHJldHVybiBhZ2VZZWFycyArICfmrbMnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICcw5q2zJyArIGFnZU1vbnRocyArICfjg7bmnIgnO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGV4cG9ydCBlbnVtIEdFTkRFUiB7XG4gICAgTUFMRSxcbiAgICBGRU1BTEUsXG4gICAgT1RIRVJcbiAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9